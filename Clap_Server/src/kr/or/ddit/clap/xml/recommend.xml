<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
         PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
         "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<!-- namespace속성 : 아래에서 작성한 SQL을 호출할 때 같이 사용된다. -->

<sqlMap namespace="recommend">

	<!-- 추천앨범전체조회 -->
	<select id="selectAllRecommendAlbum" resultClass="RecommendAlbumVO">
		SELECT RCM_ALB_NO,
			   RCM_ALB_NAME,
			   RCM_CONTENT,
			   RCM_ALB_IMAGE
		  FROM RECOMMEND_ALBUM
	</select>


	<!-- 추천앨범 등록 쿼리 -->
		<insert id="insertRecommendAlbum" parameterClass="RecommendAlbumVO">
			insert into RECOMMEND_ALBUM(
										RCM_ALB_NO,
										RCM_ALB_NAME,
										RCM_CONTENT,
										MEM_ID,
										RCM_ALB_IMAGE
			)
			values(			
										seq_rcm_alb_no.nextval,
										#rcm_alb_name#,
										#rcm_content#,
										#mem_id#,
										#rcm_alb_image#
			)
	</insert>

	<!-- Sequence조회 -->
	<select id="selectSequence" resultClass="String">
		select to_char(seq_rcm_alb_no.currval) FROM DUAL
	</select>
	
<!-- 추천앨범리스트 등록 쿼리 -->
		<insert id="insertRecommendAlbumMusic" parameterClass="java.util.HashMap">
			insert into RECOMMEND_ALBUM_LIST(
												MUS_NO,
												RCM_ALB_NO
									)
									 values(			
												#musicNo#,
												#sequence#
			)
	</insert>

	<select id="albumDetailInfo" resultClass="albumVO"
		parameterClass="String">
		        select  a.ALB_NO,
				a.ALB_NAME,
				a.ALB_SALEDATE,
				a.ALB_IMAGE,
				a.ALB_INTRO,
				a.ALB_SALE_ENTER,
				a.ALB_ENTERTAIN,
				b.SING_NAME,
				a.SING_NO
		  from ALBUM a, SINGER b
		  WHERE a.SING_NO = b.SING_NO
		    and a.ALB_NO =#String#
	</select>

	<!-- //좋이요 갯수 쿼리 -->
	<select id="selectAlbumLikeCnt" resultClass="int"
		parameterClass="String">
		SELECT count(*)
      FROM RECOMMEND_LIKE
     WHERE RCM_ALB_NO = #String#
	</select>
	
	<select id="selectAlbumListCnt" resultClass="int"
		parameterClass="String">
		  SELECT COUNT(*)
      FROM RECOMMEND_ALBUM_LIST
      WHERE RCM_ALB_NO = #String#
	</select>


 <!-- 가수정보 수정 쿼리 -->
   <update id="updateAlbumInfo" parameterClass="albumVO">
	 		update album set 
	 								ALB_NAME 		= #alb_name#,
	 								ALB_SALEDATE 	= #alb_saledate#,
	 								ALB_IMAGE 	= #alb_image#,
	 								ALB_INTRO  = #alb_intro#,
	 								ALB_SALE_ENTER 	= #alb_sale_enter#,
	 								ALB_ENTERTAIN		= #alb_entertain#,
	 								SING_NO	= #sing_no#
	 			        	where ALB_NO=#alb_no#
	 </update>




 <delete id="deleteAlbum" parameterClass="String">
			delete from album where ALB_NO=#String#
	 </delete>
</sqlMap>         




